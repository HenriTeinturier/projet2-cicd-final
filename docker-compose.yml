version: "3.9"
services:
  node-api:
    image: ghcr.io/henriteinturier/projet2-cicd-final/node-api:main
    ports:
      - "3000:80"
  frontend:
    image: ghcr.io/henriteinturier/projet2-cicd-final/frontend:main
    ports:
      - "80:80"
  cypress:
    image: cypress/included
    working_dir: /e2e
    volumes:
      - ./frontend:/e2e
    entrypoint: /bin/sh -c "ls -la /e2e && echo '---' && cypress run --config-file cypress.config.cjs --config baseUrl=http://frontend --headless --browser chrome"
    depends_on:
      - frontend
      - node-api
